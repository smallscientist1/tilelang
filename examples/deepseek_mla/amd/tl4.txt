Batch: 8, Heads: 128, kv_heads: 1, kv_ctx: 8192, dim: 512, pe_dim: 64
Tilelang output: tensor([[[-3.0960e-02, -1.4441e-01,  3.1006e-02,  ..., -3.3569e-02,
          -3.2806e-02,  8.2092e-02],
         [ 6.0883e-02, -4.4556e-03,  3.1525e-02,  ...,  3.9459e-02,
          -2.0081e-02,  3.4637e-02],
         [-5.7068e-03, -8.6914e-02, -4.7577e-02,  ..., -1.9516e-02,
          -3.7567e-02, -9.1934e-03],
         ...,
         [-2.0279e-02,  4.5319e-03,  7.2815e-02,  ...,  4.7607e-02,
           6.2286e-02,  9.4299e-02],
         [ 3.8300e-02, -5.2521e-02, -9.3018e-02,  ..., -4.7913e-03,
           7.6532e-04,  7.6233e-02],
         [ 3.0960e-02, -3.0731e-02, -5.7526e-02,  ..., -1.5869e-02,
          -2.6611e-02,  7.9163e-02]],

        [[ 2.6184e-02, -6.9641e-02, -7.2144e-02,  ...,  3.8818e-02,
           9.7885e-03,  8.1116e-02],
         [-4.4312e-02,  6.1035e-02,  3.5156e-02,  ...,  1.8829e-02,
           1.0217e-01,  2.9541e-02],
         [ 2.1835e-02,  2.3438e-02, -1.6525e-02,  ..., -4.0009e-02,
          -1.5480e-02, -4.3793e-03],
         ...,
         [ 6.5796e-02,  2.5253e-03, -1.1154e-02,  ...,  8.7891e-03,
           5.3749e-03,  3.9581e-02],
         [ 7.3547e-02,  7.5455e-03, -7.7942e-02,  ...,  1.3359e-02,
          -2.3956e-02,  2.3605e-02],
         [-1.4587e-02,  1.6357e-02, -5.4169e-02,  ...,  7.5012e-02,
           5.3925e-02,  2.1515e-02]],

        [[-5.6641e-02,  2.7527e-02, -1.7136e-02,  ...,  8.0261e-03,
          -2.0508e-02, -6.6284e-02],
         [-7.0381e-03, -2.6794e-02,  1.9196e-02,  ..., -1.8372e-02,
           4.3793e-02,  8.7830e-02],
         [-4.8180e-03,  2.6947e-02, -5.1666e-02,  ...,  9.3613e-03,
           8.8501e-04,  3.8177e-02],
         ...,
         [-6.1874e-03, -6.3515e-03,  9.7107e-02,  ...,  3.6163e-02,
          -4.5807e-02,  4.1809e-02],
         [-6.2286e-02, -5.1331e-02, -4.8126e-02,  ...,  2.5192e-02,
          -1.0557e-03,  8.4381e-03],
         [-7.5073e-02,  2.2781e-02,  8.5526e-03,  ...,  3.3264e-02,
           1.5879e-03, -1.1163e-01]],

        ...,

        [[ 1.0333e-01, -1.2703e-02,  4.2175e-02,  ...,  6.9824e-02,
           1.3275e-02,  3.0258e-02],
         [-2.5253e-02,  6.3400e-03,  5.3650e-02,  ..., -7.2388e-02,
          -1.6632e-03,  6.3599e-02],
         [-4.8248e-02, -4.5105e-02,  4.9133e-02,  ...,  3.3752e-02,
          -1.0582e-02, -5.9998e-02],
         ...,
         [ 1.6693e-02, -1.0083e-01, -6.4880e-02,  ..., -4.0405e-02,
           5.6190e-03,  1.0704e-02],
         [-7.3975e-02,  1.6998e-02, -4.8866e-03,  ...,  3.1952e-02,
          -6.5735e-02, -1.2215e-02],
         [-2.5330e-03, -2.5253e-02, -8.7585e-02,  ...,  2.6794e-02,
           3.0273e-02, -3.8391e-02]],

        [[-2.6794e-02,  7.4524e-02, -8.6060e-02,  ...,  1.3781e-04,
           2.9404e-02,  3.7506e-02],
         [-6.6589e-02, -3.3417e-02, -8.6670e-03,  ..., -3.0014e-02,
           2.9938e-02, -1.6907e-02],
         [ 1.0124e-02,  5.6976e-02,  1.1520e-02,  ...,  7.2876e-02,
          -3.5095e-02,  4.9713e-02],
         ...,
         [-7.7759e-02, -7.3608e-02,  7.5645e-03,  ..., -3.7628e-02,
          -1.0551e-02,  4.7913e-02],
         [-7.0923e-02, -8.2642e-02,  3.4210e-02,  ..., -4.1107e-02,
           1.2589e-02,  1.2433e-01],
         [ 6.0547e-02, -4.9500e-02,  2.5997e-03,  ..., -1.2787e-02,
          -6.2164e-02, -7.0648e-03]],

        [[ 2.7161e-02, -4.2908e-02, -5.2704e-02,  ..., -6.0364e-02,
          -3.9307e-02, -6.1401e-02],
         [ 7.0190e-02,  1.5945e-02,  2.6718e-02,  ...,  7.5417e-03,
          -5.2612e-02,  6.5063e-02],
         [ 5.1086e-02, -1.4526e-02,  3.7415e-02,  ..., -1.3481e-02,
          -3.3691e-02,  5.2063e-02],
         ...,
         [ 2.3407e-02,  5.4657e-02, -4.2450e-02,  ...,  2.1729e-02,
           3.7964e-02,  1.2833e-02],
         [ 4.3915e-02,  2.1683e-02,  4.1351e-03,  ...,  2.3178e-02,
          -7.3181e-02,  2.1011e-02],
         [-1.2589e-02,  1.8677e-02,  2.8091e-02,  ..., -2.4887e-02,
          -3.4576e-02,  2.8549e-02]]], device='cuda:0', dtype=torch.float16)
Ref output: tensor([[[-3.2501e-02, -1.5222e-01,  3.7720e-02,  ..., -3.5095e-02,
          -3.4698e-02,  8.3252e-02],
         [ 6.4026e-02, -1.4048e-03,  3.4973e-02,  ...,  4.0009e-02,
          -2.4063e-02,  3.1464e-02],
         [-6.0730e-03, -8.8135e-02, -5.1117e-02,  ..., -2.6276e-02,
          -4.0405e-02, -1.3138e-02],
         ...,
         [-2.0035e-02,  5.3101e-03,  8.0566e-02,  ...,  5.0446e-02,
           6.4209e-02,  9.6680e-02],
         [ 3.9337e-02, -5.0385e-02, -9.8755e-02,  ..., -7.4730e-03,
          -1.6508e-03,  7.3914e-02],
         [ 3.3234e-02, -2.8885e-02, -6.0272e-02,  ..., -2.2827e-02,
          -3.0121e-02,  8.0078e-02]],

        [[ 2.5162e-02, -7.8491e-02, -7.8796e-02,  ...,  4.0558e-02,
           1.2177e-02,  8.2153e-02],
         [-4.9377e-02,  6.6223e-02,  3.9307e-02,  ...,  1.6556e-02,
           1.1084e-01,  2.8885e-02],
         [ 2.2339e-02,  2.5909e-02, -1.9119e-02,  ..., -4.6844e-02,
          -1.6129e-02, -5.6114e-03],
         ...,
         [ 6.6956e-02,  2.8782e-03, -1.0887e-02,  ...,  6.9771e-03,
           5.7259e-03,  4.1260e-02],
         [ 7.6355e-02,  9.1934e-03, -7.9590e-02,  ...,  1.0460e-02,
          -2.5345e-02,  2.5436e-02],
         [-1.5366e-02,  1.6937e-02, -5.6671e-02,  ...,  7.7209e-02,
           5.5878e-02,  2.1454e-02]],

        [[-5.7373e-02,  2.8259e-02, -1.6159e-02,  ...,  7.1716e-03,
          -1.6876e-02, -6.9214e-02],
         [-2.0790e-03, -3.1143e-02,  2.0126e-02,  ..., -2.5177e-02,
           5.1208e-02,  9.5703e-02],
         [ 1.7729e-03,  2.6886e-02, -5.6854e-02,  ...,  7.1602e-03,
           6.5651e-03,  4.2023e-02],
         ...,
         [-2.7943e-03, -9.3307e-03,  1.0516e-01,  ...,  3.4424e-02,
          -4.3457e-02,  4.3671e-02],
         [-6.4636e-02, -5.4047e-02, -4.8401e-02,  ...,  1.9760e-02,
           3.0212e-03,  7.5226e-03],
         [-7.7698e-02,  2.6382e-02,  9.0332e-03,  ...,  3.1097e-02,
           3.5076e-03, -1.1981e-01]],

        ...,

        [[ 1.1047e-01, -1.1345e-02,  4.5013e-02,  ...,  7.4158e-02,
           9.9106e-03,  3.2990e-02],
         [-2.8519e-02,  9.7504e-03,  5.8685e-02,  ..., -7.8003e-02,
          -1.8835e-03,  6.6467e-02],
         [-5.3314e-02, -4.3274e-02,  5.3619e-02,  ...,  3.6407e-02,
          -1.2962e-02, -6.6528e-02],
         ...,
         [ 1.7105e-02, -1.0504e-01, -7.2632e-02,  ..., -4.4159e-02,
           1.8826e-03,  1.1238e-02],
         [-7.5439e-02,  2.3026e-02, -7.2670e-03,  ...,  3.3661e-02,
          -7.1411e-02, -1.6769e-02],
         [-4.7531e-03, -2.5375e-02, -9.7473e-02,  ...,  2.7618e-02,
           2.7069e-02, -4.5807e-02]],

        [[-2.9312e-02,  7.7820e-02, -9.4971e-02,  ..., -1.2612e-04,
           3.5004e-02,  4.2114e-02],
         [-7.0129e-02, -3.5248e-02, -1.2321e-02,  ..., -3.4149e-02,
           3.6133e-02, -1.9104e-02],
         [ 1.0864e-02,  6.2317e-02,  1.1169e-02,  ...,  7.6660e-02,
          -3.5858e-02,  5.2002e-02],
         ...,
         [-8.2520e-02, -7.8613e-02,  8.0719e-03,  ..., -4.1718e-02,
          -1.2573e-02,  5.1849e-02],
         [-7.3364e-02, -8.7280e-02,  3.6499e-02,  ..., -4.8279e-02,
           1.6281e-02,  1.3208e-01],
         [ 6.5674e-02, -5.3253e-02,  9.3460e-04,  ..., -1.8478e-02,
          -6.5674e-02, -7.2746e-03]],

        [[ 2.8503e-02, -4.3579e-02, -5.3802e-02,  ..., -6.4087e-02,
          -4.2053e-02, -6.8970e-02],
         [ 7.4097e-02,  2.1042e-02,  2.5024e-02,  ...,  1.1024e-02,
          -5.7434e-02,  6.7261e-02],
         [ 5.3406e-02, -1.3741e-02,  3.9978e-02,  ..., -1.4320e-02,
          -3.3783e-02,  5.5267e-02],
         ...,
         [ 2.0767e-02,  5.8502e-02, -4.6906e-02,  ...,  2.5009e-02,
           4.1473e-02,  1.3184e-02],
         [ 4.6936e-02,  2.6535e-02,  5.7297e-03,  ...,  2.9022e-02,
          -7.8308e-02,  2.2583e-02],
         [-1.7181e-02,  2.1530e-02,  3.0792e-02,  ..., -2.6215e-02,
          -3.7292e-02,  2.8854e-02]]], device='cuda:0', dtype=torch.float16)
Latency: 0.9968069791793823 ms
TFlops: 18.31208186666913 TFlops
Ref latency: 3.048504114151001 ms
Ref TFlops: 5.987727201438787 TFlops
