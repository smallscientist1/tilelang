Batch: 8, Heads: 128, kv_heads: 1, kv_ctx: 8192, dim: 512, pe_dim: 64
Tilelang output: tensor([[[-0.0271, -0.0656,  0.0281,  ...,  0.0236, -0.0148,  0.0063],
         [ 0.0194,  0.0096,  0.0398,  ..., -0.0212,  0.0180, -0.0455],
         [ 0.0467,  0.0531, -0.0252,  ...,  0.0292,  0.0153, -0.0054],
         ...,
         [ 0.0149, -0.0166,  0.0466,  ..., -0.0572,  0.0588,  0.0312],
         [-0.0267, -0.0463,  0.0260,  ...,  0.0286, -0.0539, -0.0420],
         [ 0.0978,  0.0396,  0.0002,  ..., -0.1203,  0.0315, -0.0167]],

        [[-0.0030, -0.0117, -0.0016,  ..., -0.0079,  0.0462,  0.0061],
         [-0.0276, -0.0425, -0.0051,  ..., -0.0140,  0.0356,  0.0195],
         [-0.0549, -0.0413, -0.0342,  ..., -0.0106,  0.0235,  0.0238],
         ...,
         [ 0.0431, -0.0520,  0.0251,  ..., -0.0195,  0.0489,  0.0228],
         [-0.0262, -0.0013,  0.0349,  ..., -0.0582, -0.0960,  0.0108],
         [ 0.0147, -0.0005, -0.0899,  ..., -0.0183,  0.0755,  0.0417]],

        [[ 0.0496, -0.0140, -0.0225,  ...,  0.0102, -0.0186,  0.0627],
         [-0.0755, -0.0249,  0.0101,  ..., -0.0420,  0.0263, -0.0551],
         [-0.0182,  0.0072,  0.1061,  ...,  0.0155, -0.0250,  0.0356],
         ...,
         [ 0.0190,  0.0294, -0.0638,  ..., -0.0629,  0.0126, -0.0623],
         [ 0.0462,  0.0555,  0.0165,  ..., -0.0717,  0.0058,  0.0067],
         [-0.0223,  0.0526,  0.0625,  ..., -0.0369, -0.0262,  0.0273]],

        ...,

        [[-0.0684,  0.0121,  0.0455,  ...,  0.0370, -0.0068, -0.0269],
         [-0.0196, -0.0117,  0.0010,  ..., -0.0437,  0.0612, -0.0026],
         [ 0.0110, -0.0011, -0.0673,  ...,  0.0410,  0.0732,  0.0144],
         ...,
         [ 0.0311, -0.0833,  0.0387,  ...,  0.0332,  0.0290,  0.0819],
         [-0.0056, -0.0790,  0.0267,  ..., -0.0648, -0.0010,  0.0856],
         [ 0.0229, -0.0192, -0.0627,  ..., -0.0402,  0.0721,  0.0481]],

        [[ 0.0108, -0.0030, -0.0578,  ..., -0.0229,  0.0335,  0.0234],
         [ 0.0654,  0.0190, -0.0859,  ...,  0.0050, -0.0253,  0.0209],
         [-0.0026, -0.1052, -0.1037,  ..., -0.0442, -0.0199,  0.0510],
         ...,
         [ 0.0216, -0.0213,  0.0327,  ...,  0.0059, -0.0779, -0.0137],
         [-0.0023,  0.0172, -0.0235,  ..., -0.0379, -0.0863,  0.0210],
         [ 0.0171, -0.0068, -0.0811,  ...,  0.0325,  0.0314,  0.0330]],

        [[ 0.0556,  0.0148,  0.0650,  ...,  0.0334, -0.1071, -0.0326],
         [-0.0194,  0.0115, -0.0425,  ..., -0.0486, -0.0141, -0.0675],
         [ 0.0464, -0.0416,  0.0071,  ..., -0.0598,  0.0362, -0.0127],
         ...,
         [ 0.0132, -0.0715, -0.0483,  ...,  0.0212,  0.0068,  0.0802],
         [-0.0116, -0.0350,  0.0197,  ..., -0.0759,  0.0560,  0.0430],
         [-0.0015, -0.0872, -0.0687,  ..., -0.0615,  0.0419, -0.0021]]],
       device='cuda:0', dtype=torch.float16)
Ref output: tensor([[[-0.0301, -0.0682,  0.0264,  ...,  0.0243, -0.0121,  0.0046],
         [ 0.0214,  0.0147,  0.0405,  ..., -0.0205,  0.0188, -0.0457],
         [ 0.0506,  0.0617, -0.0297,  ...,  0.0337,  0.0181, -0.0069],
         ...,
         [ 0.0177, -0.0173,  0.0457,  ..., -0.0618,  0.0648,  0.0321],
         [-0.0301, -0.0482,  0.0229,  ...,  0.0309, -0.0559, -0.0485],
         [ 0.1017,  0.0447, -0.0029,  ..., -0.1299,  0.0334, -0.0191]],

        [[ 0.0039, -0.0161,  0.0006,  ..., -0.0067,  0.0461,  0.0050],
         [-0.0287, -0.0486, -0.0013,  ..., -0.0129,  0.0317,  0.0198],
         [-0.0582, -0.0446, -0.0338,  ..., -0.0108,  0.0213,  0.0255],
         ...,
         [ 0.0472, -0.0583,  0.0287,  ..., -0.0187,  0.0470,  0.0254],
         [-0.0244, -0.0021,  0.0415,  ..., -0.0621, -0.1092,  0.0093],
         [ 0.0172, -0.0021, -0.0941,  ..., -0.0163,  0.0720,  0.0428]],

        [[ 0.0543, -0.0196, -0.0258,  ...,  0.0056, -0.0212,  0.0662],
         [-0.0809, -0.0293,  0.0105,  ..., -0.0452,  0.0269, -0.0565],
         [-0.0195,  0.0049,  0.1124,  ...,  0.0164, -0.0279,  0.0363],
         ...,
         [ 0.0210,  0.0286, -0.0680,  ..., -0.0676,  0.0158, -0.0661],
         [ 0.0512,  0.0555,  0.0193,  ..., -0.0789,  0.0078,  0.0063],
         [-0.0271,  0.0547,  0.0662,  ..., -0.0394, -0.0297,  0.0301]],

        ...,

        [[-0.0784,  0.0143,  0.0446,  ...,  0.0410, -0.0132, -0.0324],
         [-0.0245, -0.0082,  0.0014,  ..., -0.0412,  0.0603, -0.0036],
         [ 0.0094,  0.0034, -0.0750,  ...,  0.0465,  0.0721,  0.0147],
         ...,
         [ 0.0316, -0.0853,  0.0415,  ...,  0.0375,  0.0230,  0.0845],
         [-0.0040, -0.0807,  0.0297,  ..., -0.0685, -0.0040,  0.0856],
         [ 0.0249, -0.0158, -0.0682,  ..., -0.0375,  0.0698,  0.0483]],

        [[ 0.0118, -0.0021, -0.0632,  ..., -0.0295,  0.0401,  0.0240],
         [ 0.0698,  0.0203, -0.0872,  ...,  0.0047, -0.0254,  0.0217],
         [-0.0036, -0.1099, -0.1078,  ..., -0.0476, -0.0171,  0.0515],
         ...,
         [ 0.0220, -0.0205,  0.0381,  ...,  0.0053, -0.0791, -0.0175],
         [-0.0025,  0.0218, -0.0223,  ..., -0.0446, -0.0920,  0.0193],
         [ 0.0172, -0.0083, -0.0828,  ...,  0.0298,  0.0380,  0.0338]],

        [[ 0.0601,  0.0195,  0.0697,  ...,  0.0392, -0.1140, -0.0358],
         [-0.0211,  0.0158, -0.0434,  ..., -0.0503, -0.0134, -0.0763],
         [ 0.0474, -0.0407,  0.0042,  ..., -0.0590,  0.0410, -0.0157],
         ...,
         [ 0.0144, -0.0759, -0.0538,  ...,  0.0262,  0.0077,  0.0892],
         [-0.0130, -0.0362,  0.0237,  ..., -0.0792,  0.0664,  0.0463],
         [-0.0035, -0.0911, -0.0770,  ..., -0.0625,  0.0466, -0.0020]]],
       device='cuda:0', dtype=torch.float16)
Latency: 0.6544020175933838 ms
TFlops: 27.893573854079985 TFlops
Ref latency: 0.6969630122184753 ms
Ref TFlops: 26.190214814840253 TFlops
